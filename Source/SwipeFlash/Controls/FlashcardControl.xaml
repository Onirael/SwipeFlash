<UserControl x:Class="SwipeFlash.FlashcardControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:SwipeFlash"
             xmlns:core="clr-namespace:SwipeFlash.Core;assembly=SwipeFlash.Core"
             mc:Ignorable="d"
             Width="300" Height="400"
             DataContext="{x:Static core:FlashcardDesignModel.Instance}"
             local:AnimateFlipProperty.Value="{Binding IsFlipped}"
             local:InputBindingBehavior.PropagateInputBindingsToWindow="True">

    <UserControl.InputBindings>
        <!-- Flip on click -->
        <MouseBinding MouseAction="LeftClick" Command="{Binding FlipCommand}"/>
        <!-- Flip on spacebar press -->
        <KeyBinding Key="Space" Command="{Binding FlipCommand}"/>
        <!-- Swipe left -->
        <KeyBinding Key="Left" Command="{Binding SwipeLeftCommand}"/>
        <!-- Swipe right -->
        <KeyBinding Key="Right" Command="{Binding SwipeRightCommand}"/>
    </UserControl.InputBindings>

    <Grid>
        <Border Name="cardContainer"
                Background="{StaticResource BackgroundLightBrush}"
                CornerRadius="20"
                BorderThickness="1"
                BorderBrush="{StaticResource ForegroundDarkBrush}">

            <Border.Effect>
                <DropShadowEffect Opacity=".2" BlurRadius="20" ShadowDepth="0"/>
            </Border.Effect>

            <Grid>
                <!-- Icon -->
                <TextBlock Text="{Binding Side1Icon}"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Top"
                           FontSize="{StaticResource FontSizeLarger}"
                           Margin="30 30"
                           Visibility="{Binding IsOnSide1, Converter={local:BooleanToVisibilityConverter}}"/>

                <TextBlock Text="{Binding Side2Icon}"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Top"
                           FontSize="{StaticResource FontSizeLarger}"
                           Margin="30 30"
                           Visibility="{Binding IsOnSide1, Converter={local:BooleanToVisibilityConverter}, ConverterParameter=True}"/>

                <!-- Text -->
                <Grid Margin="50" Name="textContainer">
                    <Viewbox>
                        <TextBlock Text="{Binding Side1Text}" 
                                   MaxWidth="{Binding ActualWidth, ElementName=textContainer}"
                                   VerticalAlignment="Center"
                                   TextAlignment="Center"
                                   FontSize="{StaticResource FontSizeVeryLarge}"
                                   TextWrapping="WrapWithOverflow"
                                   Visibility="{Binding IsOnSide1, Converter={local:BooleanToVisibilityConverter}}"/>
                    </Viewbox>

                    <Viewbox>
                        <TextBlock Text="{Binding Side2Text}" 
                                   MaxWidth="{Binding ActualWidth, ElementName=textContainer}"
                                   VerticalAlignment="Center"
                                   TextAlignment="Center"
                                   FontSize="{StaticResource FontSizeVeryLarge}"
                                   TextWrapping="WrapWithOverflow"
                                   Visibility="{Binding IsOnSide1, Converter={local:BooleanToVisibilityConverter}, ConverterParameter=True}"/>
                    </Viewbox>
                </Grid>
            </Grid>

        </Border>
    </Grid>
</UserControl>
